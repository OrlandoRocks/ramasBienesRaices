{"ast":null,"code":"import \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport axios from \"axios\";\nimport router from \"@/router\";\n\n//const BASE_URL = \"http://localhost:3000/\";\nvar BASE_URL = process.env.VUE_APP_BACKEND_URL;\nvar state = {\n  auth_token: null,\n  errors: null,\n  user: {\n    id: null,\n    username: null,\n    email: null\n  }\n};\nvar getters = {\n  getAuthToken: function getAuthToken(state) {\n    return state.auth_token;\n  },\n  getUserEmail: function getUserEmail(state) {\n    var _state$user;\n    return (_state$user = state.user) === null || _state$user === void 0 ? void 0 : _state$user.email;\n  },\n  getUserID: function getUserID(state) {\n    var _state$user2;\n    return (_state$user2 = state.user) === null || _state$user2 === void 0 ? void 0 : _state$user2.id;\n  },\n  getError: function getError(state) {\n    return state.errors;\n  },\n  isLoggedIn: function isLoggedIn(state) {\n    var loggedOut = state.auth_token == null || state.auth_token == JSON.stringify(null);\n    return !loggedOut;\n  }\n};\nvar actions = {\n  registerUser: function registerUser(_ref, payload) {\n    var commit = _ref.commit;\n    return new Promise(function (resolve, reject) {\n      axios.post(\"\".concat(BASE_URL, \"/signup\"), payload).then(function (response) {\n        commit(\"setUserInfo\", response);\n        router.push(\"/\");\n        resolve(response);\n      }).catch(function (error) {\n        commit(\"setError\", error);\n        reject(error);\n      });\n    });\n  },\n  loginUser: function loginUser(_ref2, payload) {\n    var commit = _ref2.commit;\n    console.log(\"loginUser payload\", payload);\n    console.log(\"\".concat(BASE_URL, \"/login\"));\n    return new Promise(function (resolve, reject) {\n      axios.post(\"\".concat(BASE_URL, \"/login\"), payload).then(function (response) {\n        commit(\"setUserInfo\", response);\n        resolve(response);\n      }).catch(function (error) {\n        commit(\"setError\", error);\n        reject(error);\n      });\n    });\n  },\n  logoutUser: function logoutUser(_ref3) {\n    var commit = _ref3.commit;\n    var config = {\n      headers: {\n        Authorization: state.auth_token\n      }\n    };\n    return new Promise(function (resolve, reject) {\n      axios.post(\"\".concat(BASE_URL, \"/logout\"), {}, config).then(function () {\n        commit(\"resetUserInfo\");\n        router.push(\"/login\");\n        resolve();\n      }).catch(function (error) {\n        commit(\"setError\", error);\n        reject(error);\n      });\n    });\n  },\n  loginUserWithToken: function loginUserWithToken(_ref4, payload) {\n    var commit = _ref4.commit;\n    var config = {\n      headers: {\n        Authorization: payload.auth_token\n      }\n    };\n    return new Promise(function (resolve, reject) {\n      axios.get(\"\".concat(BASE_URL, \"/member-data\"), config).then(function (response) {\n        commit(\"setUserInfoFromToken\", response);\n        resolve(response);\n      }).catch(function (error) {\n        commit(\"setError\", error);\n        reject(error);\n      });\n    });\n  }\n};\nvar mutations = {\n  setUserInfo: function setUserInfo(state, data) {\n    state.user = data.data.data.attributes;\n    state.auth_token = data.data.meta.token;\n    axios.defaults.headers.common[\"Authorization\"] = state.auth_token;\n    localStorage.setItem(\"auth_token\", state.auth_token);\n  },\n  setError: function setError(state, error) {\n    state.errors = error;\n  },\n  setUserInfoFromToken: function setUserInfoFromToken(state, data) {\n    state.user = data.data.data.attributes;\n    state.auth_token = localStorage.getItem(\"auth_token\");\n  },\n  resetUserInfo: function resetUserInfo(state) {\n    state.user = {\n      id: null,\n      username: null,\n      email: null\n    };\n    state.auth_token = null;\n    localStorage.removeItem(\"auth_token\");\n    axios.defaults.headers.common[\"Authorization\"] = null;\n  }\n};\nexport default {\n  state: state,\n  getters: getters,\n  actions: actions,\n  mutations: mutations\n};","map":{"version":3,"names":["axios","router","BASE_URL","process","env","VUE_APP_BACKEND_URL","state","auth_token","errors","user","id","username","email","getters","getAuthToken","getUserEmail","_state$user","getUserID","_state$user2","getError","isLoggedIn","loggedOut","JSON","stringify","actions","registerUser","_ref","payload","commit","Promise","resolve","reject","post","concat","then","response","push","catch","error","loginUser","_ref2","console","log","logoutUser","_ref3","config","headers","Authorization","loginUserWithToken","_ref4","get","mutations","setUserInfo","data","attributes","meta","token","defaults","common","localStorage","setItem","setError","setUserInfoFromToken","getItem","resetUserInfo","removeItem"],"sources":["/Users/it/webstorm_projects/VueProjects/ramas_bienes_raices/src/store/modules/session_manager.js"],"sourcesContent":["import axios from \"axios\";\nimport router from \"@/router\";\n\n//const BASE_URL = \"http://localhost:3000/\";\nconst BASE_URL = process.env.VUE_APP_BACKEND_URL;\n\nconst state = {\n  auth_token: null,\n  errors: null,\n  user: {\n    id: null,\n    username: null,\n    email: null,\n  },\n};\nconst getters = {\n  getAuthToken(state) {\n    return state.auth_token;\n  },\n  getUserEmail(state) {\n    return state.user?.email;\n  },\n  getUserID(state) {\n    return state.user?.id;\n  },\n  getError(state) {\n    return state.errors;\n  },\n  isLoggedIn(state) {\n    const loggedOut =\n      state.auth_token == null || state.auth_token == JSON.stringify(null);\n    return !loggedOut;\n  },\n};\nconst actions = {\n  registerUser({ commit }, payload) {\n    return new Promise((resolve, reject) => {\n      axios\n        .post(`${BASE_URL}/signup`, payload)\n        .then((response) => {\n          commit(\"setUserInfo\", response);\n          router.push(\"/\");\n          resolve(response);\n        })\n        .catch((error) => {\n          commit(\"setError\", error);\n          reject(error);\n        });\n    });\n  },\n  loginUser({ commit }, payload) {\n    console.log(\"loginUser payload\", payload);\n    console.log(`${BASE_URL}/login`);\n    return new Promise((resolve, reject) => {\n      axios\n        .post(`${BASE_URL}/login`, payload)\n        .then((response) => {\n          commit(\"setUserInfo\", response);\n          resolve(response);\n        })\n        .catch((error) => {\n          commit(\"setError\", error);\n          reject(error);\n        });\n    });\n  },\n  logoutUser({ commit }) {\n    const config = {\n      headers: {\n        Authorization: state.auth_token,\n      },\n    };\n    return new Promise((resolve, reject) => {\n      axios\n        .post(`${BASE_URL}/logout`, {}, config)\n        .then(() => {\n          commit(\"resetUserInfo\");\n          router.push(\"/login\");\n          resolve();\n        })\n        .catch((error) => {\n          commit(\"setError\", error);\n          reject(error);\n        });\n    });\n  },\n  loginUserWithToken({ commit }, payload) {\n    const config = {\n      headers: {\n        Authorization: payload.auth_token,\n      },\n    };\n    return new Promise((resolve, reject) => {\n      axios\n        .get(`${BASE_URL}/member-data`, config)\n        .then((response) => {\n          commit(\"setUserInfoFromToken\", response);\n          resolve(response);\n        })\n        .catch((error) => {\n          commit(\"setError\", error);\n          reject(error);\n        });\n    });\n  },\n};\nconst mutations = {\n  setUserInfo(state, data) {\n    state.user = data.data.data.attributes;\n    state.auth_token = data.data.meta.token;\n    axios.defaults.headers.common[\"Authorization\"] = state.auth_token;\n    localStorage.setItem(\"auth_token\", state.auth_token);\n  },\n  setError(state, error) {\n    state.errors = error;\n  },\n  setUserInfoFromToken(state, data) {\n    state.user = data.data.data.attributes;\n    state.auth_token = localStorage.getItem(\"auth_token\");\n  },\n  resetUserInfo(state) {\n    state.user = {\n      id: null,\n      username: null,\n      email: null,\n    };\n    state.auth_token = null;\n    localStorage.removeItem(\"auth_token\");\n    axios.defaults.headers.common[\"Authorization\"] = null;\n  },\n};\nexport default {\n  state,\n  getters,\n  actions,\n  mutations,\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}