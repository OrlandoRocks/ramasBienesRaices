{"ast":null,"code":"import axios from \"axios\";\nimport router from \"@/router/router\";\n\n//const BASE_URL = \"http://localhost:3000/\";\nconst BASE_URL = process.env.VUE_APP_BACKEND_URL;\nconst state = {\n  auth_token: null,\n  errors: null,\n  user: {\n    id: null,\n    name: null,\n    last_name: null,\n    email: null\n  },\n  users: []\n};\nconst getters = {\n  getAuthToken(state) {\n    return state.auth_token;\n  },\n  getUserEmail(state) {\n    return state.user?.email;\n  },\n  getUserName(state) {\n    return state.user?.name + \" \" + state.user?.last_name;\n  },\n  getUsersList(state) {\n    return state.users;\n  },\n  getUserID(state) {\n    return state.user?.id;\n  },\n  getError(state) {\n    return state.errors;\n  },\n  isLoggedIn(state) {\n    const loggedOut = state.auth_token == null || state.auth_token == JSON.stringify(null);\n    return !loggedOut;\n  }\n};\nconst actions = {\n  registerUser({\n    commit\n  }, payload) {\n    return new Promise((resolve, reject) => {\n      axios.post(`${BASE_URL}/signup`, payload).then(response => {\n        commit(\"setUserInfo\", response);\n        router.push(\"/dashboard\");\n        resolve(response);\n      }).catch(error => {\n        commit(\"setError\", error);\n        reject(error);\n      });\n    });\n  },\n  loginUser({\n    commit\n  }, payload) {\n    return new Promise((resolve, reject) => {\n      axios.post(`${BASE_URL}/login`, payload).then(response => {\n        console.log(response);\n        commit(\"setUserInfo\", response);\n        resolve(response);\n      }).catch(error => {\n        commit(\"setError\", error);\n        reject(error);\n      });\n    });\n  },\n  logoutUser({\n    commit\n  }) {\n    const config = {\n      headers: {\n        Authorization: state.auth_token\n      }\n    };\n    return new Promise((resolve, reject) => {\n      axios.post(`${BASE_URL}/logout`, {}, config).then(() => {\n        commit(\"resetUserInfo\");\n        resolve();\n      }).catch(error => {\n        commit(\"setError\", error);\n        reject(error);\n      });\n    });\n  },\n  loginUserWithToken({\n    commit\n  }, payload) {\n    const config = {\n      headers: {\n        Authorization: payload.auth_token\n      }\n    };\n    return new Promise((resolve, reject) => {\n      axios.get(`${BASE_URL}/member-data`, config).then(response => {\n        commit(\"setUserInfoFromToken\", response);\n        resolve(response);\n      }).catch(error => {\n        commit(\"setError\", error);\n        reject(error);\n      });\n    });\n  },\n  usersList({\n    commit\n  }) {\n    const config = {\n      headers: {\n        Authorization: state.auth_token\n      }\n    };\n    return new Promise((resolve, reject) => {\n      axios.get(`${BASE_URL}/users`, config).then(response => {\n        const formattedUsers = response.data.data.map(user => {\n          const name = user.attributes.name || \"Sin nombre\";\n          const lastName = user.attributes[\"last-name\"] || \"Sin apellido\";\n          const fullName = `${name} ${lastName}`.trim();\n          return {\n            id: user.id,\n            name: name,\n            last_name: lastName,\n            full_name: fullName,\n            email: user.attributes.email || \"No email\"\n          };\n        });\n        commit(\"setUsers\", formattedUsers);\n        resolve(response);\n      }).catch(error => {\n        commit(\"setError\", error);\n        reject(error);\n      });\n    });\n  }\n};\nconst mutations = {\n  setUserInfo(state, data) {\n    state.user = data.data.data.attributes;\n    state.user.last_name = data.data.data.attributes[\"last-name\"];\n    state.auth_token = data.data.meta.token;\n    axios.defaults.headers.common[\"Authorization\"] = state.auth_token;\n    localStorage.setItem(\"auth_token\", state.auth_token);\n  },\n  setError(state, error) {\n    state.errors = error;\n  },\n  setUserInfoFromToken(state, data) {\n    state.user = data.data.data.attributes;\n    state.user.last_name = data.data.data.attributes[\"last-name\"];\n    state.auth_token = localStorage.getItem(\"auth_token\");\n  },\n  setUsers(state, data) {\n    state.users = data;\n  },\n  resetUserInfo(state) {\n    state.user = {\n      id: null,\n      name: null,\n      last_name: null,\n      email: null\n    };\n    state.auth_token = null;\n    localStorage.removeItem(\"auth_token\");\n    axios.defaults.headers.common[\"Authorization\"] = null;\n    router.push({\n      name: \"Login\"\n    });\n  }\n};\nexport default {\n  state,\n  getters,\n  actions,\n  mutations\n};","map":{"version":3,"names":["axios","router","BASE_URL","process","env","VUE_APP_BACKEND_URL","state","auth_token","errors","user","id","name","last_name","email","users","getters","getAuthToken","getUserEmail","getUserName","getUsersList","getUserID","getError","isLoggedIn","loggedOut","JSON","stringify","actions","registerUser","commit","payload","Promise","resolve","reject","post","then","response","push","catch","error","loginUser","console","log","logoutUser","config","headers","Authorization","loginUserWithToken","get","usersList","formattedUsers","data","map","attributes","lastName","fullName","trim","full_name","mutations","setUserInfo","meta","token","defaults","common","localStorage","setItem","setError","setUserInfoFromToken","getItem","setUsers","resetUserInfo","removeItem"],"sources":["/Users/it/webstorm_projects/VueProjects/ramasBienesRaices/src/store/modules/session_manager.js"],"sourcesContent":["import axios from \"axios\";\nimport router from \"@/router/router\";\n\n//const BASE_URL = \"http://localhost:3000/\";\nconst BASE_URL = process.env.VUE_APP_BACKEND_URL;\n\nconst state = {\n  auth_token: null,\n  errors: null,\n  user: {\n    id: null,\n    name: null,\n    last_name: null,\n    email: null,\n  },\n  users: [],\n};\nconst getters = {\n  getAuthToken(state) {\n    return state.auth_token;\n  },\n  getUserEmail(state) {\n    return state.user?.email;\n  },\n  getUserName(state) {\n    return state.user?.name + \" \" + state.user?.last_name;\n  },\n  getUsersList(state) {\n    return state.users;\n  },\n  getUserID(state) {\n    return state.user?.id;\n  },\n  getError(state) {\n    return state.errors;\n  },\n  isLoggedIn(state) {\n    const loggedOut =\n      state.auth_token == null || state.auth_token == JSON.stringify(null);\n    return !loggedOut;\n  },\n};\nconst actions = {\n  registerUser({ commit }, payload) {\n    return new Promise((resolve, reject) => {\n      axios\n        .post(`${BASE_URL}/signup`, payload)\n        .then((response) => {\n          commit(\"setUserInfo\", response);\n          router.push(\"/dashboard\");\n          resolve(response);\n        })\n        .catch((error) => {\n          commit(\"setError\", error);\n          reject(error);\n        });\n    });\n  },\n  loginUser({ commit }, payload) {\n    return new Promise((resolve, reject) => {\n      axios\n        .post(`${BASE_URL}/login`, payload)\n        .then((response) => {\n          console.log(response);\n          commit(\"setUserInfo\", response);\n          resolve(response);\n        })\n        .catch((error) => {\n          commit(\"setError\", error);\n          reject(error);\n        });\n    });\n  },\n  logoutUser({ commit }) {\n    const config = {\n      headers: {\n        Authorization: state.auth_token,\n      },\n    };\n    return new Promise((resolve, reject) => {\n      axios\n        .post(`${BASE_URL}/logout`, {}, config)\n        .then(() => {\n          commit(\"resetUserInfo\");\n          resolve();\n        })\n        .catch((error) => {\n          commit(\"setError\", error);\n          reject(error);\n        });\n    });\n  },\n  loginUserWithToken({ commit }, payload) {\n    const config = {\n      headers: {\n        Authorization: payload.auth_token,\n      },\n    };\n    return new Promise((resolve, reject) => {\n      axios\n        .get(`${BASE_URL}/member-data`, config)\n        .then((response) => {\n          commit(\"setUserInfoFromToken\", response);\n          resolve(response);\n        })\n        .catch((error) => {\n          commit(\"setError\", error);\n          reject(error);\n        });\n    });\n  },\n  usersList({ commit }) {\n    const config = {\n      headers: {\n        Authorization: state.auth_token,\n      },\n    };\n    return new Promise((resolve, reject) => {\n      axios\n        .get(`${BASE_URL}/users`, config)\n        .then((response) => {\n          const formattedUsers = response.data.data.map((user) => {\n            const name = user.attributes.name || \"Sin nombre\";\n            const lastName = user.attributes[\"last-name\"] || \"Sin apellido\";\n\n            const fullName = `${name} ${lastName}`.trim();\n\n            return {\n              id: user.id,\n              name: name,\n              last_name: lastName,\n              full_name: fullName,\n              email: user.attributes.email || \"No email\",\n            };\n          });\n          commit(\"setUsers\", formattedUsers);\n          resolve(response);\n        })\n        .catch((error) => {\n          commit(\"setError\", error);\n          reject(error);\n        });\n    });\n  },\n};\nconst mutations = {\n  setUserInfo(state, data) {\n    state.user = data.data.data.attributes;\n    state.user.last_name = data.data.data.attributes[\"last-name\"];\n    state.auth_token = data.data.meta.token;\n    axios.defaults.headers.common[\"Authorization\"] = state.auth_token;\n    localStorage.setItem(\"auth_token\", state.auth_token);\n  },\n  setError(state, error) {\n    state.errors = error;\n  },\n  setUserInfoFromToken(state, data) {\n    state.user = data.data.data.attributes;\n    state.user.last_name = data.data.data.attributes[\"last-name\"];\n    state.auth_token = localStorage.getItem(\"auth_token\");\n  },\n  setUsers(state, data) {\n    state.users = data;\n  },\n  resetUserInfo(state) {\n    state.user = {\n      id: null,\n      name: null,\n      last_name: null,\n      email: null,\n    };\n    state.auth_token = null;\n    localStorage.removeItem(\"auth_token\");\n    axios.defaults.headers.common[\"Authorization\"] = null;\n    router.push({ name: \"Login\" });\n  },\n};\nexport default {\n  state,\n  getters,\n  actions,\n  mutations,\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}